<role oid="b67db4c5-46f8-44f3-99fe-065092f9d05a">
    <name>Helpdesk Assign Roles</name>
    <description>Help Desk employee role</description>
    <requestable>false</requestable>
    <authorization>
        <name>gui-reviewer-access</name>
        <description>
            Allow access to certain parts of midPoint GUI. 
        </description>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#users</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#userDetails</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#findUsers</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#userViews</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#selfDashboard</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#selfCredentials</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#selfProfile</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#adminAssign</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-ui-3#adminUnassign</action>
    </authorization>
    <authorization>
        <name>users-read</name>
        <description>
			Allow to read basic user properties in UI.
		</description>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#read</action>
        <object>
            <type>UserType</type>
        </object>
        <item>assignment</item>
        <item>roleMembershipRef</item>
        <item>name</item>
        <item>givenName</item>
        <item>familyName</item>
        <item>nickName</item>
        <item>credentials</item>
    </authorization>
    <authorization>
        <description>
			Allow to modify certain user properties in UI.
		</description>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#modify</action>
        <phase>request</phase>
        <object>
            <type>UserType</type>
        </object>
        <item>assignment</item>
        <item>roleMembershipRef</item>
        <item>credentials</item>
        <item>name</item>
        <item>givenName</item>
        <item>familyName</item>
        <item>nickName</item>
    </authorization>
    <authorization>
        <description>
			Allow to modify all of user in execution phase. Access is restricted in request phase above.
		</description>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#modify</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#read</action>
        <!-- <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#delete</action> -->
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#assign</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#unassign</action>
        <phase>execution</phase>
        <object>
            <type>UserType</type>
        </object>
    </authorization>
    <authorization>
       <description>
          Allow to modify all of user shadows in execution phase. Access is restricted in request phase above.
       </description>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#modify</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#read</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#delete</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#add</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#assign</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#unassign</action>
        <phase>execution</phase>
        <object>
            <type>ShadowType</type>
        </object>
    </authorization>
    <authorization>
          <description>Allows assigning/unassigning roles.</description>
          <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#assign</action>
          <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#unassign</action>
          <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#read</action>
          <target>
              <type>RoleType</type>
          </target>
    </authorization>
</role>
