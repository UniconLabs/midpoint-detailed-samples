<?xml version="1.0"?>
<securityPolicy xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
                xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
                xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3"
                xmlns:org="http://midpoint.evolveum.com/xml/ns/public/common/org-3"
                xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
                xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instance-3"
                xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
                oid="00000000-0000-0000-0000-000000000120" version="9">
  <name>Default Security Policy</name>
  <iteration>0</iteration>
  <iterationToken/>
  <authentication>

    <modules>
      <httpBasic id="1">
          <name>internalBasic</name>
          <description>Internal username/password authentication, using HTTP basic auth</description>
      </httpBasic>
      <httpHeader id="2">
        <name>httpHeader</name>
        <description>HTTP header authentication</description>
        <usernameHeader>X-Amzn-Oidc-Identity</usernameHeader>
      </httpHeader>
    </modules>

    <sequence id="3">
      <name>admin-gui-default</name>
      <description>Default GUI authentication sequence.</description>
      <channel>
        <channelId>http://midpoint.evolveum.com/xml/ns/public/common/channels-3#user</channelId>
        <default>true</default>
        <urlSuffix>gui-default</urlSuffix>
      </channel>
      <module id="4">
        <name>httpHeader</name>
        <order>10</order>
        <necessity>sufficient</necessity>
      </module>
    </sequence>

    <sequence id="5">
      <name>actuator</name>
      <description>Authentication sequence for actuator.</description>
      <channel>
        <channelId>http://midpoint.evolveum.com/xml/ns/public/common/channels-3#actuator</channelId>
        <default>true</default>
        <urlSuffix>actuator-default</urlSuffix>
      </channel>
      <module id="6">
        <name>internalBasic</name>
        <order>10</order>
        <necessity>sufficient</necessity>
      </module>
    </sequence>

    <sequence id="7">
      <name>rest</name>
      <description>Authentication sequence for REST service.</description>
      <channel>
        <channelId>http://midpoint.evolveum.com/xml/ns/public/common/channels-3#rest</channelId>
        <default>true</default>
        <urlSuffix>rest-default</urlSuffix>
      </channel>
      <module id="8">
        <name>internalBasic</name>
        <order>10</order>
        <necessity>sufficient</necessity>
      </module>
    </sequence>

    <ignoredLocalPath>/actuator</ignoredLocalPath>
    <ignoredLocalPath>/actuator/health</ignoredLocalPath>

  </authentication>

</securityPolicy>
