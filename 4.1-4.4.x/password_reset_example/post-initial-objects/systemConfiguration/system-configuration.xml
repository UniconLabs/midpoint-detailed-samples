<!-- Add this to existing System Configuraiton object! -->
<infrastructure>
    <publicHttpUrlPattern>https://mymidpoint.edu/midpoint</publicHttpUrlPattern>
</infrastructure>

<notificationConfiguration>
        <handler>
            <passwordResetNotifier>
                <recipientExpression>
                    <script xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="c:ScriptExpressionEvaluatorType">
                        <code>return requestee.getEmailAddress()</code>
                    </script>
                </recipientExpression>
                <bodyExpression>
                    <script xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="c:ScriptExpressionEvaluatorType">
                        <code>
                           import com.evolveum.midpoint.notifications.api.events.ModelEvent
                           modelEvent = (ModelEvent) event
                           newUser = modelEvent.getFocusContext().getObjectNew();
                           userType = newUser.asObjectable();
                           link = midpoint.createPasswordResetLink(userType).replaceAll('null','https://YOUR_MIDPOINT_SERVER_URL/midpoint');
                           bodyMessage = "Did you request password reset? If yes, click on the link bellow \n" + link
                           return bodyMessage;
                        </code>
                    </script>
                </bodyExpression>
                <transport>mail</transport>
            </passwordResetNotifier>
        </handler>
    <mail>
        <server>
        <host>mailhog</host>
        <port>1025</port>
        </server>
        <defaultFrom>adminmail@example.edu</defaultFrom>
        <debug>true</debug>
    </mail>
</notificationConfiguration>
