<?xml version="1.0"?>
<!-- Resource Corresponding to the Salesforce Source of Truth for Subjects -->
<resource xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
          xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
          xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3"
          xmlns:org="http://midpoint.evolveum.com/xml/ns/public/common/org-3"
          xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
          xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instance-3"
          xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
          oid="bc3d7750-1878-4eb7-8422-4d6651f3a528">
  <name>Salesforce Inbound Subject Reconciliation Resource</name>
  <description>Provides a way to reconcile users/items from Salesforce into midPoint.</description>
  <connectorRef relation="org:default" type="c:ConnectorType">
      <!-- ConnId com.evolveum.polygon.scim.ScimConnector v4.1 -->
      <description>
            ConnId com.evolveum.polygon.scim.ScimConnector v4.1
      </description>
      <filter>
          <q:equal>
              <q:path>connectorType</q:path>
              <q:value>com.evolveum.polygon.scim.ScimConnector</q:value>
          </q:equal>
      </filter>
  </connectorRef>
  <connectorConfiguration xmlns:icfc="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/connector-schema-3"
                          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                          xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
                          xsi:type="c:ConnectorConfigurationType">
    <icfc:configurationProperties xmlns:gen696="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/bundle/com.evolveum.polygon.scim.connector-scim/com.evolveum.polygon.scim.ScimConnector"
                                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                                  xsi:type="icfc:ConfigurationPropertiesType">
      <gen696:loginURL>SALESFORCE_LOGIN_OR_VANITY_URL_HERE</gen696:loginURL>
      <gen696:userName>USERNAME_HERE</gen696:userName>
      <gen696:password>PASSWORD_WITH_SECURITY_TOKEN_HERE</gen696:password>
      <gen696:clientSecret>CLIENT_SECRET_HERE</gen696:clientSecret>
      <gen696:clientID>CLIENT_ID_HERE</gen696:clientID>
      <gen696:authentication>password</gen696:authentication>
      <gen696:endpoint>/services/scim</gen696:endpoint>
      <gen696:version>/v1</gen696:version>
      <gen696:service>/services/oauth2/token?grant_type=password</gen696:service>
    </icfc:configurationProperties>
  </connectorConfiguration>
  <schema>
  </schema>
  <schemaHandling>
    <objectType id="4">
      <kind>account</kind>
      <default>true</default>
      <objectClass>ri:AccountObjectClass</objectClass>
      <attribute>
            <c:ref>icfs:uid</c:ref>
            <displayName>Entry UUID</displayName>
            <limitations>
               <access>
                  <read>true</read>
               </access>
            </limitations>
      </attribute>
      <attribute id="5">
        <c:ref xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3">icfs:name</c:ref>
        <tolerant>true</tolerant>
        <exclusiveStrong>false</exclusiveStrong>
        <inbound id="6">
          <authoritative>true</authoritative>
          <exclusive>false</exclusive>
          <strength>normal</strength>
          <target>
            <c:path>name</c:path>
          </target>
        </inbound>
      </attribute>
      <attribute id="3">
        <c:ref xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3">ri:name.givenName</c:ref>
        <tolerant>true</tolerant>
        <exclusiveStrong>false</exclusiveStrong>
        <inbound id="6">
          <authoritative>true</authoritative>
          <exclusive>false</exclusive>
          <strength>normal</strength>
          <target>
            <c:path>givenName</c:path>
          </target>
        </inbound>
      </attribute>
      <attribute id="2">
        <c:ref xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3">ri:name.familyName</c:ref>
        <tolerant>true</tolerant>
        <exclusiveStrong>false</exclusiveStrong>
        <inbound id="6">
          <authoritative>true</authoritative>
          <exclusive>false</exclusive>
          <strength>normal</strength>
          <target>
            <c:path>familyName</c:path>
          </target>
        </inbound>
      </attribute>
    </objectType>
  </schemaHandling>
  <capabilities>
    <native xmlns:cap="http://midpoint.evolveum.com/xml/ns/public/resource/capabilities-3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3" xsi:type="c:CapabilityCollectionType">
      <cap:schema/>
      <cap:testConnection/>
      <cap:create/>
      <cap:update>
        <cap:addRemoveAttributeValues>true</cap:addRemoveAttributeValues>
      </cap:update>
      <cap:delete/>
      <cap:script>
        <cap:host>
          <cap:type>connector</cap:type>
        </cap:host>
      </cap:script>
      <cap:activation>
        <cap:status/>
      </cap:activation>
      <cap:credentials>
        <cap:password>
          <cap:returnedByDefault>false</cap:returnedByDefault>
        </cap:password>
      </cap:credentials>
      <cap:read>
        <cap:returnDefaultAttributesOption>false</cap:returnDefaultAttributesOption>
      </cap:read>
    </native>
  </capabilities>
  <synchronization>
    <objectSynchronization>
      <objectClass>AccountObjectClass</objectClass>
      <kind>account</kind>
      <focusType>c:UserType</focusType>
      <enabled>true</enabled>
      <correlation xmlns="">
        <equal xmlns="">
          <q:path>name</q:path>
          <expression xmlns="">
            <path xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3">declare namespace icfs='http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3'; $projection/attributes/name</path>
          </expression>
        </equal>
      </correlation>
      <reconcile>false</reconcile>
    </objectSynchronization>
  </synchronization>
</resource>
